version: 1
name: metrics_v1
created: "2026-02-09"
description: >
  v1 metric registry for the initial D-vs-R scoreboard. This file defines:
  (1) base series pulled from online sources, and (2) derived metrics and
  term-level aggregations.

  Notes:
  - All percent units are in "percentage points" unless otherwise stated.
  - For growth/return metrics, we prefer log-diff annualization unless noted.
  - Term attribution (e.g., inauguration/boundary rules, lag rules) is specified
    in `spec/attribution_v1.yaml`; this file only specifies metric definitions.
  - Term aggregation semantics are specified in `spec/aggregation_kinds_v1.yaml`.

sources:
  fred:
    kind: fred
    api_base_url: "https://api.stlouisfed.org/fred"
    api_key_env: FRED_API_KEY
    api_default_file_type: json
    graph_csv_url_template: "https://fred.stlouisfed.org/graph/fredgraph.csv?id={series_id}"
    notes:
      - "Prefer the official FRED API when FRED_API_KEY is available; fall back to graph CSV when it is not."
      - "FRED API requires an api_key; graph CSV usually does not, but is less stable and has less metadata."
  nber:
    kind: json
    url: "https://data.nber.org/data/cycles/business_cycle_dates.json"
  ken_french_ff_factors:
    kind: zip_csv
    url: "https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/F-F_Research_Data_Factors_CSV.zip"
    encoding: latin-1
    parse_hints:
      inner_filename_regex: "(?i)^F-F_Research_Data_Factors.*\\.csv$"
      skip_rows_until: "regex:^\\s*\\d{6}"
      date_format: "%Y%m"
      date_column_index: 0
      table_separator: "blank_line"
      use_table_index: 0
      missing_values:
        - "-99.99"
        - "-999"
    notes:
      - "Monthly Fama/French factors; includes Mkt-RF and RF in percent."
      - "CSV is not a simple header+data file; it contains descriptive preamble text and multiple tables (monthly then annual)."
  stooq:
    kind: csv
    url_template: "https://stooq.com/q/d/l/?s={symbol}&i=d"
    notes:
      - "Stooq provides historical quotes as CSV with columns: Date,Open,High,Low,Close,Volume."
      - "Index symbols are prefixed with '^' (e.g., ^spx, ^dji)."

series:
  # Macro: output
  gdpc1_real_gdp:
    source: fred
    series_id: GDPC1
    frequency: Q
    units: "billions of chained dollars (SAAR)"
    description: "Real Gross Domestic Product (BEA)."
  a939rx0q048sbea_real_gdp_per_capita:
    source: fred
    series_id: A939RX0Q048SBEA
    frequency: Q
    units: "chained dollars per person"
    description: "Real GDP per capita (BEA)."

  # Labor market
  payems_payroll_employment:
    source: fred
    series_id: PAYEMS
    frequency: M
    units: "thousands of persons"
    description: "All Employees: Total Nonfarm Payrolls (BLS CES, SA)."
  ce16ov_household_employment:
    source: fred
    series_id: CE16OV
    frequency: M
    units: "thousands of persons"
    description: "Civilian Employment Level (BLS CPS)."
  unrate_unemployment_rate:
    source: fred
    series_id: UNRATE
    frequency: M
    units: "percent"
    description: "Civilian Unemployment Rate (BLS CPS, SA)."

  # Wages
  les1252881600q_real_median_weekly_earnings:
    source: fred
    series_id: LES1252881600Q
    frequency: Q
    units: "1982-84 dollars per week"
    description: "Employed full time: Median usual weekly real earnings (CPS; CPI-adjusted)."

  # Prices
  cpiaucsl_cpi:
    source: fred
    series_id: CPIAUCSL
    frequency: M
    units: "index"
    description: "CPI-U: All Items (BLS, SA)."
    seasonal_adjustment: SA
  cpiaucns_cpi_unadjusted:
    source: fred
    series_id: CPIAUCNS
    frequency: M
    units: "index"
    description: "CPI-U: All Items (BLS, not seasonally adjusted)."
    seasonal_adjustment: NSA
  pcepi_pce_price_index:
    source: fred
    series_id: PCEPI
    frequency: M
    units: "index"
    description: "PCE Price Index (BEA, SA)."
    seasonal_adjustment: SA

  # Business cycle labels
  usrec_recession_indicator:
    source: fred
    series_id: USREC
    frequency: M
    units: "0/1 indicator"
    description: "NBER based Recession Indicators for the United States."
  nber_business_cycle_dates:
    source: nber
    frequency: irregular
    units: "peaks/troughs"
    description: "NBER business cycle chronology (peaks/troughs)."

  # Fiscal (note: some fiscal series are annual/fiscal-year based)
  gfdegdq188s_federal_debt_pct_gdp:
    source: fred
    series_id: GFDEGDQ188S
    frequency: Q
    units: "percent of GDP"
    description: "Federal Debt: Total Public Debt as Percent of GDP."
  fyfsgda188s_federal_surplus_deficit_pct_gdp:
    source: fred
    series_id: FYFSGDA188S
    frequency: A
    units: "percent of GDP"
    description: "Federal Surplus or Deficit [-] as Percent of GDP (annual)."

  # Finance (returns)
  ff_factors_monthly:
    source: ken_french_ff_factors
    dataset: "F-F_Research_Data_Factors"
    frequency: M
    units: "percent"
    columns:
      mkt_rf: "Mkt-RF"
      rf: "RF"
    derived_columns:
      mkt_total:
        expr: "mkt_rf + rf"
        units: "percent"
    description: "Fama/French Research Factors (monthly)."

  # Finance (index levels; price-only, excludes dividends)
  sp500_sp500_index:
    source: stooq
    symbol: "^spx"
    frequency: D
    units: "index"
    column: Close
    description: "S&P 500 index level (close; price index, excludes dividends)."
    filters:
      start_date: "1957-01-02"
    notes:
      - "Stooq's ^spx download includes earlier monthly values; we drop observations before 1957-01-02 (S&P 500 inception)."
  djia_dow_jones:
    source: stooq
    symbol: "^dji"
    frequency: D
    units: "index"
    column: Close
    description: "Dow Jones Industrial Average index level (close; price index, excludes dividends)."

metrics:
  # GDP growth
  - id: gdp_growth_real_qoq_ann_logdiff
    family: gdp_growth
    primary: true
    label: "Real GDP growth (QoQ annualized, log diff)"
    inputs:
      series: gdpc1_real_gdp
    period_transform:
      kind: growth_rate
      method: logdiff
      lag: 1
      annualize_periods_per_year: 4
      scale: 100
      notes:
        - "Formula: 100 * 4 * ln(GDPC1_t / GDPC1_{t-1})."
    term_aggregation:
      kind: mean

  - id: gdp_growth_real_percap_qoq_ann_logdiff
    family: gdp_growth
    primary: false
    label: "Real GDP per capita growth (QoQ annualized, log diff)"
    inputs:
      series: a939rx0q048sbea_real_gdp_per_capita
    period_transform:
      kind: growth_rate
      method: logdiff
      lag: 1
      annualize_periods_per_year: 4
      scale: 100
      notes:
        - "Formula: 100 * 4 * ln(RGDPPC_t / RGDPPC_{t-1})."
    term_aggregation:
      kind: mean

  - id: gdp_growth_real_term_cagr
    family: gdp_growth
    primary: false
    label: "Real GDP growth (term CAGR from start/end)"
    inputs:
      series: gdpc1_real_gdp
    period_transform:
      kind: identity
    term_aggregation:
      kind: cagr_from_levels
      periods_per_year: 4
      scale: 100
      notes:
        - "Uses first/last observation in the attributed window."

  # Employment
  - id: payroll_jobs_change_total
    family: jobs
    primary: true
    label: "Payroll employment change (total, end minus start)"
    inputs:
      series: payems_payroll_employment
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start
      units: "thousands of persons"

  - id: payroll_jobs_change_per_year
    family: jobs
    primary: false
    label: "Payroll employment change (per year, end minus start divided by term years)"
    inputs:
      series: payems_payroll_employment
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start_per_year
      units: "thousands of persons per year"

  - id: household_employment_change_total
    family: jobs
    primary: false
    label: "Household employment change (CPS, total, end minus start)"
    inputs:
      series: ce16ov_household_employment
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start
      units: "thousands of persons"

  - id: household_employment_change_per_year
    family: jobs
    primary: false
    label: "Household employment change (CPS, per year, end minus start divided by term years)"
    inputs:
      series: ce16ov_household_employment
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start_per_year
      units: "thousands of persons per year"

  # Unemployment
  - id: unemployment_rate_mean
    family: unemployment
    primary: true
    label: "Unemployment rate (mean during term)"
    inputs:
      series: unrate_unemployment_rate
    period_transform:
      kind: identity
    term_aggregation:
      kind: mean
      units: "percent"

  - id: unemployment_rate_change_pp
    family: unemployment
    primary: false
    label: "Unemployment rate change (percentage points, end minus start)"
    inputs:
      series: unrate_unemployment_rate
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start
      units: "percentage points"

  - id: unemployment_rate_change_pp_per_year
    family: unemployment
    primary: false
    label: "Unemployment rate change (percentage points per year, end minus start divided by term years)"
    inputs:
      series: unrate_unemployment_rate
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start_per_year
      units: "percentage points per year"

  # Wages
  - id: real_median_weekly_earnings_term_pct_change
    family: wages
    primary: true
    label: "Real median weekly earnings percent change (term total, end vs start; LES1252881600Q)"
    inputs:
      series: les1252881600q_real_median_weekly_earnings
    period_transform:
      kind: identity
    term_aggregation:
      kind: pct_change_from_levels
      scale: 100
      units: "percent"

  - id: real_median_weekly_earnings_term_cagr_pct
    family: wages
    primary: false
    label: "Real median weekly earnings CAGR (term annualized from start/end; LES1252881600Q)"
    inputs:
      series: les1252881600q_real_median_weekly_earnings
    period_transform:
      kind: identity
    term_aggregation:
      kind: cagr_from_levels
      scale: 100
      use_actual_time: true
      units: "percent"
      notes:
        - "Uses start/end levels and actual elapsed time to annualize."

  # Inflation
  - id: cpi_inflation_yoy_mean
    family: inflation
    primary: false
    label: "CPI inflation (YoY, mean during term; based on SA CPI index)"
    inputs:
      series: cpiaucsl_cpi
    period_transform:
      kind: pct_change
      lag: 12
      scale: 100
      notes:
        - "Formula: 100 * (CPI_t / CPI_{t-12} - 1)."
    term_aggregation:
      kind: mean
      units: "percent"

  - id: cpi_inflation_yoy_mean_nsa
    family: inflation
    primary: true
    label: "CPI inflation (YoY, mean during term; based on unadjusted CPI index)"
    inputs:
      series: cpiaucns_cpi_unadjusted
    period_transform:
      kind: pct_change
      lag: 12
      scale: 100
      notes:
        - "Formula: 100 * (CPI_t / CPI_{t-12} - 1)."
    term_aggregation:
      kind: mean
      units: "percent"

  - id: pce_inflation_yoy_mean
    family: inflation
    primary: false
    label: "PCE inflation (YoY, mean during term)"
    inputs:
      series: pcepi_pce_price_index
    period_transform:
      kind: pct_change
      lag: 12
      scale: 100
    term_aggregation:
      kind: mean
      units: "percent"

  - id: cpi_inflation_mom_ann_logdiff_mean
    family: inflation
    primary: false
    label: "CPI inflation (MoM annualized, log diff, mean during term)"
    inputs:
      series: cpiaucsl_cpi
    period_transform:
      kind: growth_rate
      method: logdiff
      lag: 1
      annualize_periods_per_year: 12
      scale: 100
      notes:
        - "Formula: 100 * 12 * ln(CPI_t / CPI_{t-1})."
    term_aggregation:
      kind: mean
      units: "percent"

  - id: cpi_price_level_term_pct_change_nsa
    family: inflation
    primary: false
    label: "CPI price level percent change (term total, end vs start; CPIAUCNS)"
    inputs:
      series: cpiaucns_cpi_unadjusted
    period_transform:
      kind: identity
    term_aggregation:
      kind: pct_change_from_levels
      scale: 100
      units: "percent"

  - id: cpi_price_level_term_cagr_pct_nsa
    family: inflation
    primary: false
    label: "CPI price level CAGR (term annualized from start/end; CPIAUCNS)"
    inputs:
      series: cpiaucns_cpi_unadjusted
    period_transform:
      kind: identity
    term_aggregation:
      kind: cagr_from_levels
      scale: 100
      use_actual_time: true
      units: "percent"

  # Stock returns (excess)
  - id: ff_mkt_excess_return_ann_compound
    family: stock_returns
    primary: true
    label: "Stock market excess return (annualized, compounded; Ken French Mkt-RF)"
    inputs:
      table: ff_factors_monthly
      column: mkt_rf
    period_transform:
      kind: identity
      notes:
        - "Input is percent simple return per month."
    term_aggregation:
      kind: compound_annualized
      periods_per_year: 12
      input_units: "percent"
      output_units: "percent"

  - id: ff_mkt_excess_return_ann_arith
    family: stock_returns
    primary: false
    label: "Stock market excess return (annualized, arithmetic; Ken French Mkt-RF)"
    inputs:
      table: ff_factors_monthly
      column: mkt_rf
    period_transform:
      kind: identity
    term_aggregation:
      kind: mean_times_periods_per_year
      periods_per_year: 12
      units: "percent"

  - id: ff_mkt_total_return_ann_compound
    family: stock_returns
    primary: false
    label: "Stock market total return (annualized, compounded; Ken French Mkt-RF + RF)"
    inputs:
      table: ff_factors_monthly
      column: mkt_total
    period_transform:
      kind: identity
      notes:
        - "Derived monthly total return: (Mkt-RF + RF), in percent simple return per month."
    term_aggregation:
      kind: compound_annualized
      periods_per_year: 12
      input_units: "percent"
      output_units: "percent"

  - id: ff_mkt_total_return_term_total
    family: stock_returns
    primary: false
    label: "Stock market total return (term total, compounded; Ken French Mkt-RF + RF)"
    inputs:
      table: ff_factors_monthly
      column: mkt_total
    period_transform:
      kind: identity
    term_aggregation:
      kind: compound_total
      input_units: "percent"
      output_units: "percent"
      notes:
        - "Formula: 100 * (prod_t (1 + r_t/100) - 1) over months in the attributed term window."

  - id: ff_mkt_excess_return_volatility_ann
    family: stock_returns
    primary: false
    label: "Stock market excess return volatility (annualized std dev; Ken French Mkt-RF)"
    inputs:
      table: ff_factors_monthly
      column: mkt_rf
    period_transform:
      kind: identity
    term_aggregation:
      kind: annualized_std
      periods_per_year: 12
      input_units: "percent"
      output_units: "percent"

  - id: ff_mkt_excess_return_sharpe_ann
    family: stock_returns
    primary: false
    label: "Stock market Sharpe ratio (annualized; Ken French Mkt-RF)"
    inputs:
      table: ff_factors_monthly
      column: mkt_rf
    period_transform:
      kind: identity
    term_aggregation:
      kind: sharpe_ratio_annualized
      periods_per_year: 12
      units: "ratio"
      notes:
        - "Formula: mean(Mkt-RF)*12 / (std(Mkt-RF)*sqrt(12))."

  # Stock index levels (price-only)
  - id: sp500_term_pct_change
    family: stock_levels
    primary: false
    label: "S&P 500 percent change (term total, end vs start)"
    inputs:
      series: sp500_sp500_index
    period_transform:
      kind: identity
    term_aggregation:
      kind: pct_change_from_levels
      scale: 100
      units: "percent"

  - id: sp500_term_cagr_pct
    family: stock_levels
    primary: false
    label: "S&P 500 CAGR (term annualized from start/end)"
    inputs:
      series: sp500_sp500_index
    period_transform:
      kind: identity
    term_aggregation:
      kind: cagr_from_levels
      scale: 100
      use_actual_time: true
      units: "percent"
      notes:
        - "Uses start/end levels and actual elapsed time to annualize."

  - id: djia_term_pct_change
    family: stock_levels
    primary: false
    label: "Dow Jones Industrial Average percent change (term total, end vs start)"
    inputs:
      series: djia_dow_jones
    period_transform:
      kind: identity
    term_aggregation:
      kind: pct_change_from_levels
      scale: 100
      units: "percent"

  - id: djia_term_cagr_pct
    family: stock_levels
    primary: false
    label: "Dow Jones Industrial Average CAGR (term annualized from start/end)"
    inputs:
      series: djia_dow_jones
    period_transform:
      kind: identity
    term_aggregation:
      kind: cagr_from_levels
      scale: 100
      use_actual_time: true
      units: "percent"
      notes:
        - "Uses start/end levels and actual elapsed time to annualize."

  # Recessions
  - id: recession_month_share
    family: recessions
    primary: true
    label: "Recession share of months (USREC mean)"
    inputs:
      series: usrec_recession_indicator
    period_transform:
      kind: identity
    term_aggregation:
      kind: mean
      post_scale: 100
      units: "percent of months"

  - id: recession_start_count
    family: recessions
    primary: false
    label: "Recession starts (count of 0->1 transitions in USREC)"
    inputs:
      series: usrec_recession_indicator
    period_transform:
      kind: identity
    term_aggregation:
      kind: count_transitions
      from_value: 0
      to_value: 1
      units: "count"

  # Fiscal
  - id: federal_debt_pct_gdp_mean
    family: fiscal
    primary: true
    label: "Federal debt (%GDP, mean; GFDEGDQ188S)"
    inputs:
      series: gfdegdq188s_federal_debt_pct_gdp
    period_transform:
      kind: identity
    term_aggregation:
      kind: mean
      units: "percent of GDP"

  - id: federal_debt_pct_gdp_end
    family: fiscal
    primary: false
    label: "Federal debt (%GDP, end-of-term value; GFDEGDQ188S)"
    inputs:
      series: gfdegdq188s_federal_debt_pct_gdp
    period_transform:
      kind: identity
    term_aggregation:
      kind: last
      units: "percent of GDP"

  - id: federal_debt_pct_gdp_change_pp
    family: fiscal
    primary: false
    label: "Federal debt (%GDP, change in percentage points, end minus start; GFDEGDQ188S)"
    inputs:
      series: gfdegdq188s_federal_debt_pct_gdp
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start
      units: "percentage points"

  - id: federal_debt_pct_gdp_change_pp_per_year
    family: fiscal
    primary: false
    label: "Federal debt (%GDP, change in percentage points per year; GFDEGDQ188S)"
    inputs:
      series: gfdegdq188s_federal_debt_pct_gdp
    period_transform:
      kind: identity
    term_aggregation:
      kind: end_minus_start_per_year
      units: "percentage points per year"

  - id: federal_surplus_deficit_pct_gdp_mean
    family: fiscal
    primary: false
    label: "Federal surplus/deficit (%GDP, mean; FYFSGDA188S)"
    inputs:
      series: fyfsgda188s_federal_surplus_deficit_pct_gdp
    period_transform:
      kind: identity
    term_aggregation:
      kind: mean
      units: "percent of GDP"

known_omissions:
  - family: housing
    reason: "Deferred to v2 (candidates: CSUSHPISA, HOUST)."
  - family: interest_rates
    reason: "Deferred to v2 (candidates: FEDFUNDS, DGS10, T10Y2Y)."
  - family: trade
    reason: "Deferred to v2 (candidates: BOPGSTB)."
  - family: inequality
    reason: "Deferred to v2 (high-quality distributional metrics are typically annual with lag)."
